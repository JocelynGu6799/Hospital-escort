"use strict";const e=require("./util.js"),t=require("../../../../common/vendor.js"),a=require("./i18n/index.js"),{t:i}=t.initVueI18n(a.i18nMessages),s={components:{calendarItem:()=>"./calendar-item.js",timePicker:()=>"./time-picker.js"},options:{virtualHost:!0},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default:()=>({})},selected:{type:Array,default:()=>[]},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default:()=>({before:"",after:"",data:[],fulldate:""})},defaultValue:{type:[String,Object,Array],default:""}},data:()=>({show:!1,weeks:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""}}),watch:{date:{immediate:!0,handler(e){this.range||(this.tempSingleDate=e,setTimeout((()=>{this.init(e)}),100))}},defTime:{immediate:!0,handler(e){this.range?(this.timeRange.startTime=e.start,this.timeRange.endTime=e.end):this.time=e}},startDate(e){this.cale&&(this.cale.setStartDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(e){this.cale&&(this.cale.setEndDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(e){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,e),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(e){const{before:t,after:a,fulldate:i,which:s}=e;this.tempRange.before=t,this.tempRange.after=a,setTimeout((()=>{if(i)if(this.cale.setHoverMultiple(i),t&&a){if(this.cale.lastHover=!0,this.rangeWithinMonth(a,t))return;this.setDate(t)}else this.cale.setMultiple(i),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(t,a),"left"===s&&t?(this.setDate(t),this.weeks=this.cale.weeks):a&&(this.setDate(a),this.weeks=this.cale.weeks),this.cale.lastHover=!0}}),16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText:()=>i("uni-datetime-picker.selectDate"),startDateText(){return this.startPlaceholder||i("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||i("uni-datetime-picker.endDate")},okText:()=>i("uni-datetime-picker.ok"),yearText:()=>i("uni-datetime-picker.year"),monthText:()=>i("uni-datetime-picker.month"),MONText:()=>i("uni-calender.MON"),TUEText:()=>i("uni-calender.TUE"),WEDText:()=>i("uni-calender.WED"),THUText:()=>i("uni-calender.THU"),FRIText:()=>i("uni-calender.FRI"),SATText:()=>i("uni-calender.SAT"),SUNText:()=>i("uni-calender.SUN"),confirmText:()=>i("uni-calender.confirm")},created(){this.cale=new e.Calendar({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range}),this.init(this.date)},methods:{leaveCale(){this.firstEnter=!0},handleMouse(e){if(e.disable)return;if(this.cale.lastHover)return;let{before:t,after:a}=this.cale.multipleStatus;t&&(this.calendar=e,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(e,t){const[a,i]=e.split("-"),[s,n]=t.split("-");return a===s&&i===n},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(e){const t=e.detail.value+"-1";this.setDate(t)},init(t){if(this.cale&&(this.cale.setDate(t||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(t),this.calendar={...this.nowDate},!t&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const t=new Date(this.defaultValue),a=e.getDate(t),i=t.getFullYear(),s=t.getMonth()+1,n=t.getDate(),l=t.getDay();this.calendar={fullDate:a,year:i,month:s,date:n,day:l},this.tempSingleDate=a,this.time=e.getTime(t,this.hideSecond)}},open(){this.clearDate&&!this.insert&&(this.cale.cleanMultipleStatus(),this.init(this.date)),this.show=!0,this.$nextTick((()=>{setTimeout((()=>{this.aniMaskShow=!0}),50)}))},close(){this.aniMaskShow=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1,this.$emit("close")}),300)}))},confirm(){this.setEmit("confirm"),this.close()},change(e){(this.insert||e)&&this.setEmit("change")},monthSwitch(){let{year:e,month:t}=this.nowDate;this.$emit("monthSwitch",{year:e,month:Number(t)})},setEmit(t){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=e.getTime(new Date,this.hideSecond)));let{year:a,month:i,date:s,fullDate:n,extraInfo:l}=this.calendar;this.$emit(t,{range:this.cale.multipleStatus,year:a,month:i,date:s,time:this.time,timeRange:this.timeRange,fulldate:n,extraInfo:l||{}})},choiceDate(e){if(e.disable)return;this.calendar=e,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const t=new Date(this.cale.multipleStatus.before).getTime(),a=new Date(this.cale.multipleStatus.after).getTime();t>a&&a?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change(!0)},changeMonth(e){let t;"pre"===e?t=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:"next"===e&&(t=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(t),this.monthSwitch()},setDate(e){this.cale.setDate(e),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e)}}};if(!Array){(t.resolveComponent("calendar-item")+t.resolveComponent("time-picker")+t.resolveComponent("uni-icons"))()}Math;const n=t._export_sfc(s,[["render",function(e,a,i,s,n,l){return t.e({a:!i.insert&&n.show},!i.insert&&n.show?{b:n.aniMaskShow?1:"",c:t.o(((...e)=>l.maskClick&&l.maskClick(...e)))}:{},{d:i.insert||n.show},i.insert||n.show?t.e({e:t.o((e=>l.changeMonth("pre"))),f:t.t((n.nowDate.year||"")+l.yearText+(n.nowDate.month||"")+l.monthText),g:i.date,h:t.o(((...e)=>l.bindDateChange&&l.bindDateChange(...e))),i:t.o((e=>l.changeMonth("next"))),j:!i.insert},i.insert?{}:{k:t.o(((...e)=>l.maskClick&&l.maskClick(...e)))},{l:i.insert?"":1,m:i.showMonth},i.showMonth?{n:t.t(n.nowDate.month)}:{},{o:t.t(l.SUNText),p:t.t(l.MONText),q:t.t(l.TUEText),r:t.t(l.WEDText),s:t.t(l.THUText),t:t.t(l.FRIText),v:t.t(l.SATText),w:t.f(n.weeks,((e,a,s)=>({a:t.f(e,((e,a,h)=>({a:t.o(l.choiceDate,a),b:t.o(l.handleMouse,a),c:"6876aaaa-0-"+s+"-"+h,d:t.p({weeks:e,calendar:n.calendar,selected:i.selected,checkHover:i.range}),e:a}))),b:a}))),x:!i.insert&&!i.range&&i.hasTime},i.insert||i.range||!i.hasTime?{}:{y:t.t(n.tempSingleDate?n.tempSingleDate:l.selectDateText),z:t.o((e=>n.time=e)),A:t.p({type:"time",start:l.timepickerStartTime,end:l.timepickerEndTime,disabled:!n.tempSingleDate,border:!1,"hide-second":i.hideSecond,modelValue:n.time})},{B:!i.insert&&i.range&&i.hasTime},!i.insert&&i.range&&i.hasTime?{C:t.t(n.tempRange.before?n.tempRange.before:l.startDateText),D:t.o((e=>n.timeRange.startTime=e)),E:t.p({type:"time",start:l.timepickerStartTime,border:!1,"hide-second":i.hideSecond,disabled:!n.tempRange.before,modelValue:n.timeRange.startTime}),F:t.p({type:"arrowthinright",color:"#999"}),G:t.t(n.tempRange.after?n.tempRange.after:l.endDateText),H:t.o((e=>n.timeRange.endTime=e)),I:t.p({type:"time",end:l.timepickerEndTime,border:!1,"hide-second":i.hideSecond,disabled:!n.tempRange.after,modelValue:n.timeRange.endTime})}:{},{J:!i.insert},i.insert?{}:{K:t.t(l.confirmText),L:t.o(((...e)=>l.confirm&&l.confirm(...e)))},{M:i.insert?"":1,N:n.aniMaskShow?1:"",O:n.aniMaskShow?1:""}):{},{P:t.o(((...e)=>l.leaveCale&&l.leaveCale(...e)))})}]]);wx.createComponent(n);
