"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("counter")+e.resolveComponent("formater")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../components/counter/counter.js")+(()=>"../../components/formater/formater.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const t={__name:"order",setup(t){const r=getApp();e.onLoad((e=>{s(e.oid)}));let n=e.ref({});const a=e.computed((()=>({"待支付":"10","待服务":"20","已完成":"30","已取消":"40"}[n.value.trade_state]))),s=t=>{r.globalData.utils.myrequest({myurl:"/order/detail",header:{token:e.index.getStorageSync("token")},data:{oid:t},mysuccess:e=>{console.log("订单详情res",e),n.value=e.data},myfail:t=>(console.log("获取订单详情信息错误",t),e.index.showToast({title:"获取订单详情信息错误",icon:"error"}))})},o=()=>{s()},u=e.ref(),i=()=>{console.log("订单信息",n),r.globalData.utils.myrequest({myurl:"/pay/createOrder",method:"POST",data:n.value,header:{token:e.index.getStorageSync("token")},mysuccess:t=>{console.log("订单提交信息",t),u.value.open("center");const r=new e.UQRCode;r.data=t.wx_code,r.size=200,r.make();var n=e.index.createCanvasContext("qrcode");r.canvasContext=n,r.drawCanvas()},myfail:t=>(console.log("订单提交错误信息",t),e.index.showToast({title:"订单提交错误",icon:"error"}))})},c=t=>{e.index.makePhoneCall({phoneNumber:t.currentTarget.dataset.tel})},m=()=>{e.index.switchTab({url:"../myorder/index"})};return(t,r)=>e.e({a:e.n("od-jd od-jd-"+a.value),b:10==a.value},10==a.value?{c:e.o(o),d:e.p({second:e.unref(n)._exp_time}),e:e.t(e.unref(n).price),f:e.o(i)}:{},{g:20==a.value},20==a.value?e.e({h:0==e.unref(n).service_state},(e.unref(n).service_state,{}),{i:1==e.unref(n).service_state},(e.unref(n).service_state,{})):{},{j:30==a.value},(a.value,{}),{k:40==a.value},(a.value,{}),{l:20==a.value},20==a.value?{m:e.unref(n)._staff.avatar_url,n:e.t(e.unref(n)._staff.nickname),o:e.o(c),p:e.unref(n)._staff.mobile}:{},{q:e.t(e.unref(n).service_name),r:e.unref(n).service_stype<=20},e.unref(n).service_stype<=20?e.e({s:e.t(e.unref(n).hospital_name),t:e.p({timestamp:e.unref(n).starttime,format:"YYYY-MM-dd hh:mm"}),v:e.t(e.unref(n).client_name),w:e.t(1==e.unref(n).client_sex?"男":"女"),x:e.t(e.unref(n).client_age),y:e.t(e.unref(n).tel),z:15==e.unref(n).service_stype},15==e.unref(n).service_stype?{A:e.t(e.unref(n).receiveAddress)}:{}):{},{B:e.unref(n).service_stype>20&&e.unref(n).service_stype<100},e.unref(n).service_stype>20&&e.unref(n).service_stype<100?{C:e.t(e.unref(n).hospital_name),D:e.p({timestamp:e.unref(n).starttime,format:"YYYY-MM-dd hh:mm"}),E:e.t(e.unref(n).address.userName),F:e.t(e.unref(n).address.telNumber),G:e.t(e.unref(n).address.cityName),H:e.t(e.unref(n).address.countyName),I:e.t(e.unref(n).address.detailInfo)}:{},{J:e.unref(n).service_stype>100},e.unref(n).service_stype>100?{K:e.p({timestamp:e.unref(n).starttime,format:"YYYY-MM-dd hh:mm"}),L:e.t(e.unref(n).client_name),M:e.t(1==e.unref(n).client_sex?"男":"女"),N:e.t(e.unref(n).client_age),O:e.t(e.unref(n).client_mobile),P:e.t(e.unref(n).address.address)}:{},{Q:e.t(e.unref(n).demand),R:e.t(e.unref(n).tel),S:e.p({timestamp:e.unref(n).order_start_time,format:"YYYY-MM-dd hh:mm"}),T:e.t(e.unref(n).price),U:20==a.value},20==a.value?{V:e.t(e.unref(n).price),W:e.p({timestamp:e.unref(n).pay_time,format:"YYYY-MM-dd hh:mm"})}:{},{X:e.t(e.unref(n).out_trade_no),Y:e.o(m),Z:e.sr(u,"1e7b4881-6",{k:"qrcodePopup"}),aa:e.p({type:"center","is-mask-click":!1,"background-color":"#fff"})})}};wx.createPage(t);
